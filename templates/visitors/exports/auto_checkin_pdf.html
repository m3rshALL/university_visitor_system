<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Auto Check-in Dashboard Report</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            font-size: 10pt;
            color: #333;
            line-height: 1.4;
        }
        
        h1 {
            color: #206bc4;
            font-size: 18pt;
            margin-bottom: 10px;
            border-bottom: 2px solid #206bc4;
            padding-bottom: 5px;
        }
        
        h2 {
            color: #206bc4;
            font-size: 14pt;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .meta {
            font-size: 9pt;
            color: #666;
            margin-bottom: 20px;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .stat-box {
            text-align: center;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 30%;
        }
        
        .stat-value {
            font-size: 24pt;
            font-weight: bold;
            color: #206bc4;
        }
        
        .stat-label {
            font-size: 9pt;
            color: #666;
            margin-top: 5px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
            font-size: 9pt;
        }
        
        table thead {
            background-color: #f3f5f7;
        }
        
        table th {
            padding: 8px;
            text-align: left;
            border-bottom: 2px solid #206bc4;
            font-weight: bold;
        }
        
        table td {
            padding: 6px 8px;
            border-bottom: 1px solid #e6e9ec;
        }
        
        table tr:hover {
            background-color: #f8f9fa;
        }
        
        .badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 8pt;
            font-weight: bold;
        }
        
        .badge-success {
            background-color: #d4edda;
            color: #155724;
        }
        
        .badge-danger {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .badge-warning {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .footer {
            margin-top: 30px;
            padding-top: 10px;
            border-top: 1px solid #ddd;
            font-size: 8pt;
            color: #666;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Auto Check-in Dashboard Report</h1>
        <div class="meta">
            <strong>–ü–µ—Ä–∏–æ–¥:</strong> {{ data.start_date|date:"d.m.Y H:i" }} - {{ data.end_date|date:"d.m.Y H:i" }} ({{ data.days }} –¥–Ω–µ–π)<br>
            <strong>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ:</strong> {{ generated_at|date:"d.m.Y H:i:s" }}<br>
            <strong>–°–æ—Ç—Ä—É–¥–Ω–∏–∫:</strong> {{ generated_by }}
        </div>
    </div>
    
    <h2>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
    <div class="stats">
        <div class="stat-box">
            <div class="stat-value">{{ data.total_auto_checkins }}</div>
            <div class="stat-label">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—Ö–æ–¥–æ–≤</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">{{ data.total_auto_checkouts }}</div>
            <div class="stat-label">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã—Ö–æ–¥–æ–≤</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">{{ data.incidents|length }}</div>
            <div class="stat-label">–ê–Ω–æ–º–∞–ª–∏–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</div>
        </div>
    </div>
    
    <h2>‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ Check-ins (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100)</h2>
    <table>
        <thead>
            <tr>
                <th>–î–∞—Ç–∞/–í—Ä–µ–º—è</th>
                <th>–ì–æ—Å—Ç—å</th>
                <th>–ü—Ä–∏–Ω–∏–º–∞—é—â–∏–π</th>
                <th>–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in data.auto_checkins %}
            <tr>
                <td>{{ entry.timestamp|date:"d.m.Y H:i:s" }}</td>
                <td>{{ entry.guest }}</td>
                <td>{{ entry.employee }}</td>
                <td>{{ entry.department }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center; color: #999;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div style="page-break-before: always;"></div>
    
    <h2>üö™ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ Check-outs (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100)</h2>
    <table>
        <thead>
            <tr>
                <th>–î–∞—Ç–∞/–í—Ä–µ–º—è</th>
                <th>–ì–æ—Å—Ç—å</th>
                <th>–ü—Ä–∏–Ω–∏–º–∞—é—â–∏–π</th>
                <th>–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in data.auto_checkouts %}
            <tr>
                <td>{{ entry.timestamp|date:"d.m.Y H:i:s" }}</td>
                <td>{{ entry.guest }}</td>
                <td>{{ entry.employee }}</td>
                <td>{{ entry.department }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center; color: #999;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div style="page-break-before: always;"></div>
    
    <h2>üö® Security Incidents (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50)</h2>
    <table>
        <thead>
            <tr>
                <th>–î–∞—Ç–∞</th>
                <th>–¢–∏–ø</th>
                <th>–£—Ä–æ–≤–µ–Ω—å</th>
                <th>–ì–æ—Å—Ç—å</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
        </thead>
        <tbody>
            {% for incident in data.incidents %}
            <tr>
                <td>{{ incident.detected_at|date:"d.m.Y H:i" }}</td>
                <td>{{ incident.get_incident_type_display }}</td>
                <td>
                    {% if incident.severity == 'critical' %}
                    <span class="badge badge-danger">{{ incident.get_severity_display }}</span>
                    {% elif incident.severity == 'high' %}
                    <span class="badge badge-danger">{{ incident.get_severity_display }}</span>
                    {% elif incident.severity == 'medium' %}
                    <span class="badge badge-warning">{{ incident.get_severity_display }}</span>
                    {% else %}
                    <span class="badge badge-success">{{ incident.get_severity_display }}</span>
                    {% endif %}
                </td>
                <td>{{ incident.visit.guest.full_name|default:"-" }}</td>
                <td>{{ incident.get_status_display }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="text-align: center; color: #999;">–ù–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    <div class="footer">
        <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –°–∏—Å—Ç–µ–º–æ–π –ü—Ä–æ–ø—É—Å–∫–æ–≤ –£–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞</p>
        <p>–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç. –¢–æ–ª—å–∫–æ –¥–ª—è —Å–ª—É–∂–µ–±–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.</p>
    </div>
</body>
</html>

