{% load iin_filters %}
<div id="advanced-table" hx-target="#advanced-table" hx-swap="outerHTML">
  {% include 'visitors/_visit_table.html' %}
  <div class="card-footer d-flex align-items-center">
    <p class="m-0 text-secondary">Показано <span>{{ page_obj.start_index }}-{{ page_obj.end_index }}</span> из <span>{{ page_obj.paginator.count }}</span> записей</p>
    <div class="dropdown ms-3">
      <a class="btn dropdown-toggle" data-bs-toggle="dropdown">
        <span id="page-count" class="me-1">{{ request.GET.per_page|default:page_obj.paginator.per_page }}</span>
        <span>записей на странице</span>
      </a>
      <div class="dropdown-menu">
        <a class="dropdown-item {% if request.GET.per_page == '10' or not request.GET.per_page and page_obj.paginator.per_page == 10 %}active{% endif %}"
           hx-get="?per_page=10" hx-target="#advanced-table" hx-push-url="true">10 записей</a>
        <a class="dropdown-item {% if request.GET.per_page == '20' or not request.GET.per_page and page_obj.paginator.per_page == 20 %}active{% endif %}"
           hx-get="?per_page=20" hx-target="#advanced-table" hx-push-url="true">20 записей</a>
        <a class="dropdown-item {% if request.GET.per_page == '50' or not request.GET.per_page and page_obj.paginator.per_page == 50 %}active{% endif %}"
           hx-get="?per_page=50" hx-target="#advanced-table" hx-push-url="true">50 записей</a>
        <a class="dropdown-item {% if request.GET.per_page == '100' or not request.GET.per_page and page_obj.paginator.per_page == 100 %}active{% endif %}"
           hx-get="?per_page=100" hx-target="#advanced-table" hx-push-url="true">100 записей</a>
      </div>
    </div>
    <ul class="pagination m-0 ms-auto">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link" hx-get="?page={{ page_obj.previous_page_number }}{% if filter_params_url %}&{{ filter_params_url }}{% endif %}" hx-target="#advanced-table" hx-push-url="true" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-1">
              <path d="M15 6l-6 6l6 6" />
            </svg>
            prev
          </a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <a class="page-link" href="#" tabindex="-1" aria-disabled="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-1">
              <path d="M15 6l-6 6l6 6" />
            </svg>
            prev
          </a>
        </li>
      {% endif %}
      {% if page_obj.number > 3 %}
        <li class="page-item">
          <a class="page-link" hx-get="?page=1{% if filter_params_url %}&{{ filter_params_url }}{% endif %}" hx-target="#advanced-table" hx-push-url="true">1</a>
        </li>
        {% if page_obj.number > 4 %}
          <li class="page-item disabled">
            <span class="page-link">...</span>
          </li>
        {% endif %}
      {% endif %}
      {% for i in page_obj.paginator.page_range %}
        {% if i > page_obj.number|add:"-3" and i < page_obj.number|add:"3" %}
          {% if i == page_obj.number %}
            <li class="page-item active">
              <span class="page-link">{{ i }}</span>
            </li>
          {% else %}
            <li class="page-item">
              <a class="page-link" hx-get="?page={{ i }}{% if filter_params_url %}&{{ filter_params_url }}{% endif %}" hx-target="#advanced-table" hx-push-url="true">{{ i }}</a>
            </li>
          {% endif %}
        {% endif %}
      {% endfor %}
      {% if page_obj.number < page_obj.paginator.num_pages|add:"-2" %}
        {% if page_obj.number < page_obj.paginator.num_pages|add:"-3" %}
          <li class="page-item disabled">
            <span class="page-link">...</span>
          </li>
        {% endif %}
        <li class="page-item">
          <a class="page-link" hx-get="?page={{ page_obj.paginator.num_pages }}{% if filter_params_url %}&{{ filter_params_url }}{% endif %}" hx-target="#advanced-table" hx-push-url="true">{{ page_obj.paginator.num_pages }}</a>
        </li>
      {% endif %}
      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link" hx-get="?page={{ page_obj.next_page_number }}{% if filter_params_url %}&{{ filter_params_url }}{% endif %}" hx-target="#advanced-table" hx-push-url="true">
            next
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-1">
              <path d="M9 6l6 6l-6 6" />
            </svg>
          </a>
        </li>
      {% else %}
        <li class="page-item disabled">
          <a class="page-link" href="#" aria-disabled="true">
            next
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-1">
              <path d="M9 6l6 6l-6 6" />
            </svg>
          </a>
        </li>
      {% endif %}
    </ul>
  </div>
</div>

