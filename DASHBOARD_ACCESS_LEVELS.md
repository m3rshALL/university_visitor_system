# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω–µ–π –¥–æ—Å—Ç—É–ø–∞ –∫ Dashboards

**–î–∞—Ç–∞:** 14.10.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–ê–°–¢–†–û–ï–ù–û**

---

## üìä DASHBOARDS –ò –£–†–û–í–ù–ò –î–û–°–¢–£–ü–ê

### 1. Auto Check-in Dashboard
**URL:** `/visitors/dashboards/auto-checkin/`  
**Permission:** `visitors.view_visit`

**–ö—Ç–æ –≤–∏–¥–∏—Ç:**
- ‚úÖ –í—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –ø—Ä–∞–≤–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–∑–∏—Ç–æ–≤
- ‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤
- ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã

**–ß—Ç–æ –≤–∏–¥–∏—Ç:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö check-in/checkout
- –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ö–æ–¥–æ–≤ —á–µ—Ä–µ–∑ —Ç—É—Ä–Ω–∏–∫–µ—Ç—ã
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- –¢–æ–ø-10 –∞–Ω–æ–º–∞–ª–∏–π

---

### 2. Security Incidents Dashboard
**URL:** `/visitors/dashboards/security-incidents/`  
**Permission:** `visitors.view_securityincident`

**–ö—Ç–æ –≤–∏–¥–∏—Ç:**
- ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Security Admins)
- ‚úÖ –°—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- ‚ö†Ô∏è –ù–ï –≤–∏–¥—è—Ç –æ–±—ã—á–Ω—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏

**–ß—Ç–æ –≤–∏–¥–∏—Ç:**
- –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ security incidents
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ severity, status, type
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

---

### 3. HikCentral Dashboard
**URL:** `/visitors/dashboards/hikcentral/`  
**Permission:** `visitors.view_visit`

**–ö—Ç–æ –≤–∏–¥–∏—Ç:**
- ‚úÖ –í—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –ø—Ä–∞–≤–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∏–∑–∏—Ç–æ–≤
- ‚úÖ IT –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- ‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä—ã

**–ß—Ç–æ –≤–∏–¥–∏—Ç:**
- –°—Ç–∞—Ç—É—Å HikCentral —Å–µ—Ä–≤–µ—Ä–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- Rate limiter status
- Performance metrics

---

## üéØ –ù–ê–°–¢–†–û–ô–ö–ê –ì–†–£–ü–ü –î–û–°–¢–£–ü–ê

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ Django Admin (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

1. –û—Ç–∫—Ä–æ–π—Ç–µ Django Admin: `http://localhost:8000/admin/`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ì—Ä—É–ø–ø—ã** (`Auth` > `Groups`)
3. –°–æ–∑–¥–∞–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã:

#### –ì—Ä—É–ø–ø–∞: "Security Admins"
**–ü—Ä–∞–≤–∞:**
```
‚úÖ visitors | visit | Can view visit
‚úÖ visitors | security incident | Can view security incident
‚úÖ visitors | security incident | Can change security incident
‚úÖ visitors | audit log | Can view audit log
```

**–ß–ª–µ–Ω—ã –≥—Ä—É–ø–ø—ã:**
- –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å–ª—É–∂–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ì–ª–∞–≤–Ω—ã–π –æ—Ö—Ä–∞–Ω–Ω–∏–∫
- –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

#### –ì—Ä—É–ø–ø–∞: "Department Managers"
**–ü—Ä–∞–≤–∞:**
```
‚úÖ visitors | visit | Can view visit
‚úÖ visitors | visit | Can add visit
‚úÖ visitors | visit | Can change visit
‚úÖ visitors | guest | Can view guest
```

**–ß–ª–µ–Ω—ã –≥—Ä—É–ø–ø—ã:**
- –†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤
- HR –º–µ–Ω–µ–¥–∂–µ—Ä—ã
- –°–µ–∫—Ä–µ—Ç–∞—Ä–∏

---

#### –ì—Ä—É–ø–ø–∞: "IT Administrators"
**–ü—Ä–∞–≤–∞:**
```
‚úÖ visitors | visit | Can view visit
‚úÖ hikvision_integration | hik central server | Can view hik central server
‚úÖ hikvision_integration | hik central server | Can change hik central server
```

**–ß–ª–µ–Ω—ã –≥—Ä—É–ø–ø—ã:**
- IT —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- DevOps

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–°–æ–∑–¥–∞–π—Ç–µ management command –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä—É–ø–ø:

**–§–∞–π–ª:** `visitor_system/visitors/management/commands/setup_dashboard_permissions.py`

```python
from django.core.management.base import BaseCommand
from django.contrib.auth.models import Group, Permission
from django.contrib.contenttypes.models import ContentType


class Command(BaseCommand):
    help = 'Setup dashboard access groups and permissions'
    
    def handle(self, *args, **options):
        # Security Admins Group
        security_group, created = Group.objects.get_or_create(name='Security Admins')
        if created:
            self.stdout.write(self.style.SUCCESS('Created group: Security Admins'))
        
        # Add permissions
        permissions = [
            'visitors.view_visit',
            'visitors.view_securityincident',
            'visitors.change_securityincident',
            'visitors.view_auditlog',
        ]
        
        for perm_str in permissions:
            app_label, codename = perm_str.split('.')
            try:
                perm = Permission.objects.get(
                    codename=codename,
                    content_type__app_label=app_label
                )
                security_group.permissions.add(perm)
                self.stdout.write(f'  Added permission: {perm_str}')
            except Permission.DoesNotExist:
                self.stdout.write(
                    self.style.WARNING(f'  Permission not found: {perm_str}')
                )
        
        # Department Managers Group
        managers_group, created = Group.objects.get_or_create(name='Department Managers')
        if created:
            self.stdout.write(self.style.SUCCESS('Created group: Department Managers'))
        
        permissions = [
            'visitors.view_visit',
            'visitors.add_visit',
            'visitors.change_visit',
            'visitors.view_guest',
        ]
        
        for perm_str in permissions:
            app_label, codename = perm_str.split('.')
            try:
                perm = Permission.objects.get(
                    codename=codename,
                    content_type__app_label=app_label
                )
                managers_group.permissions.add(perm)
            except Permission.DoesNotExist:
                pass
        
        # IT Administrators Group
        it_group, created = Group.objects.get_or_create(name='IT Administrators')
        if created:
            self.stdout.write(self.style.SUCCESS('Created group: IT Administrators'))
        
        permissions = [
            'visitors.view_visit',
            'hikvision_integration.view_hikcentralserver',
            'hikvision_integration.change_hikcentralserver',
        ]
        
        for perm_str in permissions:
            app_label, codename = perm_str.split('.')
            try:
                perm = Permission.objects.get(
                    codename=codename,
                    content_type__app_label=app_label
                )
                it_group.permissions.add(perm)
            except Permission.DoesNotExist:
                pass
        
        self.stdout.write(
            self.style.SUCCESS('Successfully setup dashboard permissions!')
        )
```

**–ó–∞–ø—É—Å–∫:**
```bash
cd visitor_system
poetry run python manage.py setup_dashboard_permissions
```

---

## üîí –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –£–†–û–í–ù–ò –ó–ê–©–ò–¢–´

### 1. IP-based restrictions (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ Security Incidents Dashboard —Ç–æ–ª—å–∫–æ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö IP:

**–§–∞–π–ª:** `visitor_system/visitors/dashboards.py`

```python
from django.http import HttpResponseForbidden

ALLOWED_IPS_FOR_SECURITY = [
    '192.168.1.100',  # Security office
    '192.168.1.101',  # IT department
    '127.0.0.1',      # Localhost
]

@login_required
@permission_required('visitors.view_securityincident', raise_exception=True)
def security_incidents_dashboard(request):
    # IP-based check
    client_ip = request.META.get('REMOTE_ADDR')
    if client_ip not in ALLOWED_IPS_FOR_SECURITY:
        return HttpResponseForbidden(
            'Access to Security Incidents Dashboard is restricted to authorized IPs only.'
        )
    
    # ... rest of the code ...
```

---

### 2. Time-based restrictions (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ dashboards —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è:

```python
from django.utils import timezone

@login_required
@permission_required('visitors.view_securityincident', raise_exception=True)
def security_incidents_dashboard(request):
    # Time-based check (work hours only)
    now = timezone.now()
    work_start = 8  # 08:00
    work_end = 18   # 18:00
    
    if now.hour < work_start or now.hour >= work_end:
        if not request.user.is_superuser:
            return HttpResponseForbidden(
                'Access to Security Incidents Dashboard is only available during work hours (08:00-18:00).'
            )
    
    # ... rest of the code ...
```

---

### 3. Multi-factor Authentication (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–¢—Ä–µ–±—É–π—Ç–µ 2FA –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Security Incidents Dashboard:

```python
@login_required
@permission_required('visitors.view_securityincident', raise_exception=True)
def security_incidents_dashboard(request):
    # Check if user has 2FA enabled
    if hasattr(request.user, 'two_factor_enabled'):
        if not request.user.two_factor_enabled:
            messages.warning(
                request,
                'Two-Factor Authentication is required for Security Dashboard access.'
            )
            return redirect('enable_2fa')
    
    # ... rest of the code ...
```

---

## üìã CHECKLIST –ü–û –ù–ê–°–¢–†–û–ô–ö–ï

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—ã
```bash
# –í Django Admin
http://localhost:8000/admin/auth/group/

# –ò–ª–∏ —á–µ—Ä–µ–∑ management command
poetry run python manage.py setup_dashboard_permissions
```

### –®–∞–≥ 2: –ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```bash
# –í Django Admin
http://localhost:8000/admin/auth/user/

# –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –¥–æ "Groups"
3. –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ –≥—Ä—É–ø–ø—ã
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

1. **–û–±—ã—á–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫:**
   - ‚úÖ –í–∏–¥–∏—Ç Auto Check-in Dashboard
   - ‚ùå –ù–ï –≤–∏–¥–∏—Ç Security Incidents Dashboard
   - ‚úÖ –í–∏–¥–∏—Ç HikCentral Dashboard

2. **Security Admin:**
   - ‚úÖ –í–∏–¥–∏—Ç –≤—Å–µ 3 dashboards
   - ‚úÖ –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞–º–∏

3. **IT Administrator:**
   - ‚úÖ –í–∏–¥–∏—Ç –≤—Å–µ 3 dashboards
   - ‚úÖ –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å HCP —Å–µ—Ä–≤–µ—Ä–∞–º–∏

---

## üé® –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –í EMPLOYEE DASHBOARD

–í `employee_dashboard.html` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã permissions checks:

```django
<!-- Auto Check-in Dashboard -->
{% if perms.visitors.view_visit %}
<div class="col-md-4 col-lg-3">
    <a href="{% url 'auto_checkin_dashboard' %}" ...>
        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
    </a>
</div>
{% endif %}

<!-- Security Incidents Dashboard -->
{% if perms.visitors.view_securityincident %}
<div class="col-md-4 col-lg-3">
    <a href="{% url 'security_incidents_dashboard' %}" ...>
        Security Incidents
    </a>
</div>
{% endif %}

<!-- HikCentral Dashboard -->
{% if perms.visitors.view_visit %}
<div class="col-md-4 col-lg-3">
    <a href="{% url 'hikcentral_dashboard' %}" ...>
        HikCentral Dashboard
    </a>
</div>
{% endif %}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–∞—Ä—Ç–æ—á–∫–∏ dashboards –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å –Ω—É–∂–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏—Ö –Ω–µ –≤–∏–¥—è—Ç

---

## üìä –ú–ê–¢–†–ò–¶–ê –î–û–°–¢–£–ü–ê

| –†–æ–ª—å / Dashboard | Auto Check-in | Security Incidents | HikCentral |
|-----------------|---------------|-------------------|------------|
| –û–±—ã—á–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ | ‚úÖ | ‚ùå | ‚úÖ |
| Department Manager | ‚úÖ | ‚ùå | ‚úÖ |
| Security Admin | ‚úÖ | ‚úÖ | ‚úÖ |
| IT Administrator | ‚úÖ | ‚ö†Ô∏è (view only) | ‚úÖ |
| Superuser | ‚úÖ | ‚úÖ | ‚úÖ |

---

## üîê BEST PRACTICES

1. **Principle of Least Privilege**
   - –î–∞–≤–∞–π—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á
   - Security Incidents - —Ç–æ–ª—å–∫–æ security team

2. **Regular Audits**
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —Ä–∞–∑ –≤ –∫–≤–∞—Ä—Ç–∞–ª
   - –£–¥–∞–ª—è–π—Ç–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —É—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏

3. **Logging**
   - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ Security Incidents –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ AuditLog
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

4. **Training**
   - –û–±—É—á–∞–π—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é dashboards
   - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

---

## ‚úÖ –ò–¢–û–ì

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- ‚úÖ 3 dashboards —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ Permissions checks –≤ views
- ‚úÖ –£—Å–ª–æ–≤–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ Employee Dashboard
- ‚úÖ –ì–æ—Ç–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

**–î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:**
1. –°–æ–∑–¥–∞–π—Ç–µ –≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ Django Admin
2. –ù–∞–∑–Ω–∞—á—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** üü¢ –í—ã—Å–æ–∫–∞—è

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 14.10.2025

